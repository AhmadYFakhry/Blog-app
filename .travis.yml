language: node_js
node_js:
  - "12"
dist: trusty
services:
  - mongodb
  - redis-server
env:
  global:
    - NODE_ENV=ci
    - PORT=3000
    - secure: XPCXqD6xa5eiZ1u7los8AS4HoFUCGC7QlBpscvoEOvqdrkuVeVZ7je2EQVhP8DGVFl3Zpo7jPXxM/mUTNpVyOVn9RdPVzZ6P/Lb5qbLyyM2UXGZ+uatAJmVgTKOzjeQNnvoa47aVl6gbYDdjP/2rWUtHxL9TYgnRYMm9TSKo1LXfnIn109e/LKOMRqPVMdlH1y7P0ociIQ7I9Ne2J/Jbq8Y7ZVsbBq7PHUhDW4QU5vxTqscZGefHSmMwhP3q9/ShomFWo9JL6LkFZhmUCQb2zf9xMZU7WvypSnqauBjZND/tdzY0qMDTtsaf+m+Oh380LycDjbhcRzEGTb1G6bsQ0PHjrn33oOCwtgF8FLe83vXnO8oXtLyEXKsvezLdc8GOrbOBV8/3iYm4F9RYmEzO+ySWd3/6LY5Qgm99ku4tu7usjcZo/JzhF9K9BAtVUVmcm33SpkHsLE32019Qn5ns6hZbVwRl1/80D2c44hSPM1TB0UPorGNnO9czljDRULH1uwno7+NDdKKeiJ8qg3i0bUlXCb89xIEFTCR2eUW4BOgEt9QLiAHdEQBYn8DNtS0duerOSSBTjEv1RR2n/aC6J75kYR9jYATqMnoN6hvT+0/R8IrJWTi343nB/B0Y95ksfZxl0ZG0FWw4d1W4JH2ZSoi2Ku7pLck202EaNV/Ksy8=
    - secure: lSQwkUCJdT8HdNmhOixf7wNOXIv31dCR8aVWG/5KO+MYSvDpPJmXi7hgj+lkq/Na0sWCnuQeVxKKLbYiPVBjmimZNSUrUYIRTmihiq/RRpPBwIm3KbV5xX82YSCuLvL4De53N3FgeP0Eh0xKr/5Ma+m4ylUpQF2H3I5GY0hVcvEMK65e7S027yWNOoDqUdIA/bjU4/A4yFYDH5Gnd8SugTecKsls0xC36cDBKBx1pm/G0lDnskj/QhmzQ0E1vtM6sWbi9t1wVc89zp2ubl4vHtZQRPxLucQyNE0Q/CJGKCrxVqDZqd5t2R36Brtl3AewUhDcdOTzXWkbU0MUpubm4xkBcX+WK+8X0IAkl3nkzYYGr6VszqkGkDLfDy6UkNj08ZDJ1uMdvNfytMtMQokS7lAO72krjbz4R8wX504+KeWKEyXsvBQKnb5WOY0KspqblBO3OOwmF5jFJrKmQAj4HBcaPp9zjoTy+Buoh27nIx32Zx4j9fZkUMoS5uQASRstwbuiWXCofF5jIzClRKNej5M+Kqz7O4o7m+3TPDc9Kl2/wpcUobwuyAaFJx/Vq6+/wVH0pxYVOC/YUX61KSr8nSXF9+dcYJvZbpby1rAp6H2W1ZCqboRC+j+KISbAozAx2cf1dbhFbyC1o15HqfyxDaPs+el/VRFgEDklb5dwrns=
    - secure: Xh60s5hE9deX/iyLwNkzmQoPljd4ZNfTvnPqyzmvlvUtFkZB4KLJkAZph2Vxqb2cBkOPGD/KBYFOhqO/8NECtg5dECguxkQERKv4uZcyZEHHxCvVM5NI9muw1i0yG7g8Z2POragrpdKFfkSDGNlORvDEJLtSzE/4HaAtsxBGGWvBEnLAD2PzL01Ay5kW9qepUo5j6cMMtfUDGyH2Mqm7bmAiv17ALFCi6t2QvgXdgPIWYAnBdsGOaeFW3DTRw6vmvDBWV/1arfqHKBso/7gSdEo7mw1stRsC5p1zbLSI5Nj7lXlLMaHJG/TbKFt9A9eaK3ggn9PbXY2zv9rEFqhl1Hy2jcerhZD66n92Z5QqtLn4sle7wvawSXib2Q2oniCb/CrVOHkYxuhkuMDH1PRj7k5nZOsFLGy/0/zjvaebhYRbTXJme8IRlf/ApJTcmTMMaOKx2To1kIVKIs5JKnIRwqvK1xJxuvqiK4MJJnaTzd+widv7mjD6z9N515nv6kyHDWRdGPibaL4lJ5WeAQZVhJWlwJHHtXHZ+mxdjkijdPHJoZtlA/cEDGC2O1QkKNf+y8gZ3Sd5eM+KB+CczRMRdbdSv6hcmw6z9AbBP91eh/gHIr/zCm0ctqhtHRGnuPtsr8BLp7PpRnZXrY5xLwInMYsoA6Nnm20+TovXYnbaBBk=
    - secure: lLh/v4UY4mdQ1P4PDNtIkkw5qbD5rLLQtVOTOnMw2SozMv+KQFDGIRkn1NgUa+UvFdzwNPpivVrO0Nf0qHIlv7M8F+OTGe94WiUz1iJy0ekf3SWDLGR+B5qrEH7tJVM9Z0hyqvxm7b3O3wc5qz02mDG6nDtOgzdYAk6KDbZkkrmkEpQvbpuvEDKcXtT0UihO1LhDjoDlJMh4539bg2u97HEkaHj4ZUypKa5y/0L+VMelD59xd9f1C9+77AXfRs2Xqhmyx1iYuGOKZ5aWSZNpB9Kee6s4+AGyXi1pkot4fbnQW3gARtkeS7H/Sme6EoUBGdD28MiLbaBJpabNVPVABai4VQyI5aw3MHj/iTdFyDrgqbBM/JRXjF5+EIjn8wCLasd0d6f+g6Tshm8gj/QWoZaYgXrrEA5C0dD+vhs04AkKpDzeSC6KhhhAUgC9yRQ8DziZzCFtGjdvrz4jPf3wVK/XF76Zo4CWH/rlNXiE1yB6c8Ovht5JNZRWfArMOLjONtVlxp67xgj7cWWq3ktjWMI36HlM0BY0MQaqudCiM2B0doYz1irtcXOufmijjN/+ywH/ywJ9+s2fUo7kSrf8G3dh2EUMalrbEQDsM+nYCqXtJ14d+ZK6oATeY6B3AB9zqQJDJB95iQcLeIIKIw3sw7DBsDr0n0llcCxLp2ZGHPM=
    - secure: Rrn08BMRVl91PxCbifmNt1Jsceu5IuVR4eZow8eqjnRHCQeQAS/X/UaagCZ4cnZ4YeXkUI5EZ1pNl+oSpZbyliJIHg6zq9PHt0wM3COf7DVwm2A/wwnyCgTHT3VNu4qOVlBFgF5Sv42227YWKGSe/UOZi4WD5EfvZ8etAe2TzJB7lsrAD32CRoD+qUUGGYVYGKcOacHNI7x2aa9M+7QGGFvUOyggOTmO38Oyx9yoC+BiI7wnoG/+WQw2pzI2MOdVIYNNU+9/vckGMFNn4+HLa3P8WPMW6IiW68dm1fPSmcJGbGN4BRE+ghW2lFm0iaCrC5d33I4xT60bwUCnaWSjqnekJv1oUacnacCRPKFqDFpm+Ha6YcQY5l7y+OfXKfCFFy5Hd4b+z0KE4QVTnMprRYHyzd1IHN4Arhl94DefY1ImnPlUt32zUOiL2bzUCqqH3buxALOxQxQXaKU/kNGpX8sUoouLc9YwJYtQ6QwCAeYDJyGyzhpE4WYvueHAwGi7lryBYHWZOK8/RDxJ6L+Mu/SHDywXu+NOwzl75yq+l4Fm5+W2gcrnYCXl+/lduz2DZD6RQHQIg6BzQg/gJBscwhElHa7m/8M3wBe+u4Xd3FyqKLa8ZiEegAmhttY10+b1ST1cJvw38ZzBj90UQCBRpMhP5E2mvXpD/zkNoiT0XjQ=
cache:
  directories:
    - node_modules
    - client/node_modules
install:
  - npm install
  - npm run build
script:
  - nohup npm run start &
  - sleep 4
  - npm run test
